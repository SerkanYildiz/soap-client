<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  <link rel="shortcut icon" href="../img/favicon.ico">
  <title>Use your preferred data transfer layer with Handlers - SOAP Client Docs</title>
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">
  
  <script>
    // Current page data
    var mkdocs_page_name = "Use your preferred data transfer layer with Handlers";
    var mkdocs_page_input_path = "handlers.md";
    var mkdocs_page_url = null;
  </script>
  
  <script src="../js/jquery-2.1.1.min.js" defer></script>
  <script src="../js/modernizr-2.8.3.min.js" defer></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href=".." class="icon icon-home"> SOAP Client Docs</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
	<ul class="current">
	  
          
            <li class="toctree-l1">
		
    <a class="" href="..">Home</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../client/">Creating your custom client</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../events/">Hooking in with events</a>
	    </li>
          
            <li class="toctree-l1 current">
		
    <a class="current" href="./">Use your preferred data transfer layer with Handlers</a>
    <ul class="subnav">
            
    <li class="toctree-l2"><a href="#use-your-preferred-data-transfer-layer-with-handlers">Use your preferred data transfer layer with Handlers</a></li>
    
        <ul>
        
            <li><a class="toctree-l3" href="#soaphandle">SoapHandle</a></li>
        
            <li><a class="toctree-l3" href="#httplughandle">HttPlugHandle</a></li>
        
            <li><a class="toctree-l3" href="#localsoapserverhandle">LocalSoapServerHandle</a></li>
        
        </ul>
    

    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../middlewares/">Get control of the HTTP layer with middlewares</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../testing/">Testing</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../type-converter/">Convert SOAP types</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../usage/">Basic Usage</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../wsdl-providers/">Get in control of the WSDL file</a>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Cli</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../cli/generate-classmap/">Generating class maps</a>
                </li>
                <li class="">
                    
    <a class="" href="../cli/generate-client/">Generating clients</a>
                </li>
                <li class="">
                    
    <a class="" href="../cli/generate-clientfactory/">Generate a base client factory</a>
                </li>
                <li class="">
                    
    <a class="" href="../cli/generate-types/">Generating Value-objects</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Code generation</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../code-generation/assemblers/">Code assemblers</a>
                </li>
                <li class="">
                    
    <a class="" href="../code-generation/configuration/">Configuration</a>
                </li>
                <li class="">
                    
    <a class="" href="../code-generation/rules/">Code generation rules</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Plugins</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../plugins/caching/">Caching plugin</a>
                </li>
                <li class="">
                    
    <a class="" href="../plugins/logger/">Logger plugin</a>
                </li>
                <li class="">
                    
    <a class="" href="../plugins/validator/">Validator plugin</a>
                </li>
    </ul>
	    </li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="..">SOAP Client Docs</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="..">Docs</a> &raquo;</li>
    
      
    
    <li>Use your preferred data transfer layer with Handlers</li>
    <li class="wy-breadcrumbs-aside">
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="use-your-preferred-data-transfer-layer-with-handlers">Use your preferred data transfer layer with Handlers</h1>
<p>The build-in SOAP client doesn't support extensions by default.
To overcome this problem, you are forced to overwrite the <code>__doRequest()</code> method.
By doing this, your code will be tied to the SoapClient which makes it hard to test and to reuse the logic.</p>
<p>This package contains a handler system which allows you to get control over the HTTP layer of the soap client.
The handler system makes it possible to make changes to the request and the response before sending it to the server. </p>
<p>Here is a list of built-in handlers:</p>
<ul>
<li><a href="#soaphandle">SoapHandle</a></li>
<li><a href="#guzzlehandle">HttPlugHandle</a></li>
<li><a href="#localsoapserverhandle">LocalSoapServerHandle</a></li>
</ul>
<h2 id="soaphandle">SoapHandle</h2>
<p><em>Features: LastRequestInfoCollector</em></p>
<p>The SoapHandle is used by default and works with the built-in <code>__doRequest()</code> method.
This Handle is not configurable and can be used for soap implementations which do not use extensions.
It is activated by default to get you going as quick as posible.</p>
<p><strong>Configuration</strong></p>
<pre><code class="php">$clientBuilder = new ClientBuilder($clientFactory, $wsdl, $soapOptions);
$client = $clientBuilder-&gt;build();
</code></pre>

<h2 id="httplughandle">HttPlugHandle</h2>
<p><em>Features: LastRequestInfoCollector, MiddlewareSupporting</em></p>
<p><a href="http://httplug.io/">HTTPlug</a> is a HTTP client abstraction that can be used with multiple client packages.
With this handler it is easy to get in control about the HTTP layer of the SOAP client.
You can specify one or multiple middlewares that are being applied on your http client.
This makes it possible to manipulate the request and response objects so that you can get full control.</p>
<p>This handler is based on middlewares which are applied to your guzzle client.
<a href="../middlewares/">You can read more about middlewares in this section.</a></p>
<p><strong>Dependencies</strong></p>
<p>Load HTTP plug core packages:</p>
<pre><code class="sh">composer require psr/http-message:^1.0 php-http/httplug:^1.1 php-http/message-factory:^1.0 php-http/discovery:^1.3 php-http/message:^1.6 php-http/client-common:^1.6
</code></pre>

<p><strong>Select HTTP Client</strong></p>
<p>Select one of the many clients you want to use to perform the HTTP requests:
http://docs.php-http.org/en/latest/clients.html#clients-adapters</p>
<pre><code class="sh">composer require php-http/client-implementation:^1.0
</code></pre>

<p><strong>Configuration</strong></p>
<pre><code class="php">$clientBuilder = new ClientBuilder($clientFactory, $wsdl, $soapOptions);
$clientBuilder-&gt;withHandler(HttPlugHandle::createForClient($httpClient));
$client = $clientBuilder-&gt;build();
</code></pre>

<h2 id="localsoapserverhandle">LocalSoapServerHandle</h2>
<p><em>Features: LastRequestInfoCollector</em></p>
<p>The LocalSoapServerHandle can be used to link the soap-client to a local PHP SoapServer instance.
This handle can be used for testing purposes, it is not recommended to use it in production.</p>
<p>*NOTE: * Since SoapServer is sending headers, you want to run this handler in a separate process.
You can use <code>@runInSeparateProcess</code> in PHPunit.</p>
<p><strong>Configuration</strong></p>
<pre><code class="php">$soapServer = new \SoapServer('some.wsdl', []);
$soapServer-&gt;setObject($someTestingImplementation);

$clientBuilder = new ClientBuilder($clientFactory, $wsdl, $soapOptions);
$clientBuilder-&gt;withHandler(new LocalSoapServerHandle($soapServer));
$client = $clientBuilder-&gt;build();
</code></pre>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../middlewares/" class="btn btn-neutral float-right" title="Get control of the HTTP layer with middlewares">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../events/" class="btn btn-neutral" title="Hooking in with events"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
      
        <span><a href="../events/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../middlewares/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '..';</script>
    <script src="../js/theme.js" defer></script>
      <script src="../search/main.js" defer></script>

</body>
</html>
