<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  <link rel="shortcut icon" href="../../img/favicon.ico">
  <title>Code assemblers - SOAP Client Docs</title>
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">
  
  <script>
    // Current page data
    var mkdocs_page_name = "Code assemblers";
    var mkdocs_page_input_path = "code-generation/assemblers.md";
    var mkdocs_page_url = null;
  </script>
  
  <script src="../../js/jquery-2.1.1.min.js" defer></script>
  <script src="../../js/modernizr-2.8.3.min.js" defer></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href="../.." class="icon icon-home"> SOAP Client Docs</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
	<ul class="current">
	  
          
            <li class="toctree-l1">
		
    <a class="" href="../..">Home</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../../client/">Creating your custom client</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../../events/">Hooking in with events</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../../handlers/">Use your preferred data transfer layer with Handlers</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../../middlewares/">Get control of the HTTP layer with middlewares</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../../testing/">Testing</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../../type-converter/">Convert SOAP types</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../../usage/">Basic Usage</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../../wsdl-providers/">Get in control of the WSDL file</a>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Cli</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../cli/generate-classmap/">Generating class maps</a>
                </li>
                <li class="">
                    
    <a class="" href="../../cli/generate-client/">Generating clients</a>
                </li>
                <li class="">
                    
    <a class="" href="../../cli/generate-clientfactory/">Generate a base client factory</a>
                </li>
                <li class="">
                    
    <a class="" href="../../cli/generate-types/">Generating Value-objects</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Code generation</span>
    <ul class="subnav">
                <li class=" current">
                    
    <a class="current" href="./">Code assemblers</a>
    <ul class="subnav">
            
    <li class="toctree-l3"><a href="#code-assemblers">Code assemblers</a></li>
    

    <li class="toctree-l3"><a href="#built-in-assemblers">Built-in assemblers</a></li>
    
        <ul>
        
            <li><a class="toctree-l4" href="#classmapassembler">ClassMapAssembler</a></li>
        
            <li><a class="toctree-l4" href="#constructorassembler">ConstructorAssembler</a></li>
        
            <li><a class="toctree-l4" href="#fluentsetterassembler">FluentSetterAssembler</a></li>
        
            <li><a class="toctree-l4" href="#finalclassassembler">FinalClassAssembler</a></li>
        
            <li><a class="toctree-l4" href="#extendassembler">ExtendAssembler</a></li>
        
            <li><a class="toctree-l4" href="#getterassembler">GetterAssembler</a></li>
        
            <li><a class="toctree-l4" href="#interfaceassembler">InterfaceAssembler</a></li>
        
            <li><a class="toctree-l4" href="#iteratorassembler">IteratorAssembler</a></li>
        
            <li><a class="toctree-l4" href="#jsonserializableassembler">JsonSerializableAssembler</a></li>
        
            <li><a class="toctree-l4" href="#propertyassembler">PropertyAssembler</a></li>
        
            <li><a class="toctree-l4" href="#requestassembler">RequestAssembler</a></li>
        
            <li><a class="toctree-l4" href="#resultassembler">ResultAssembler</a></li>
        
            <li><a class="toctree-l4" href="#resultproviderassembler">ResultProviderAssembler</a></li>
        
            <li><a class="toctree-l4" href="#setterassembler">SetterAssembler</a></li>
        
            <li><a class="toctree-l4" href="#traitassembler">TraitAssembler</a></li>
        
            <li><a class="toctree-l4" href="#useassembler">UseAssembler</a></li>
        
            <li><a class="toctree-l4" href="#immutablesetterassembler">ImmutableSetterAssembler</a></li>
        
        </ul>
    

    <li class="toctree-l3"><a href="#creating-your-own-assembler">Creating your own Assembler</a></li>
    

    </ul>
                </li>
                <li class="">
                    
    <a class="" href="../configuration/">Configuration</a>
                </li>
                <li class="">
                    
    <a class="" href="../rules/">Code generation rules</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Plugins</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../plugins/caching/">Caching plugin</a>
                </li>
                <li class="">
                    
    <a class="" href="../../plugins/logger/">Logger plugin</a>
                </li>
                <li class="">
                    
    <a class="" href="../../plugins/validator/">Validator plugin</a>
                </li>
    </ul>
	    </li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../..">SOAP Client Docs</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../..">Docs</a> &raquo;</li>
    
      
        
          <li>Code generation &raquo;</li>
        
      
    
    <li>Code assemblers</li>
    <li class="wy-breadcrumbs-aside">
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="code-assemblers">Code assemblers</h1>
<p>Code assemblers are a thin layer above <a href="https://github.com/zendframework/zend-code">zend-code</a>.
There are a lot of built-in assemblers but it is also possible to create your own assembler 
to generate the code you want to add to the generated SOAP types.</p>
<h1 id="built-in-assemblers">Built-in assemblers</h1>
<ul>
<li><a href="#classmapassembler">ClassMapAssembler</a></li>
<li><a href="#constructorassembler">ConstructorAssembler</a></li>
<li><a href="#extendassembler">ExtendAssembler</a></li>
<li><a href="#finalclassassembler">FinalClassAssembler</a></li>
<li><a href="#fluentsetterassembler">FluentSetterAssembler</a></li>
<li><a href="#getterassembler">GetterAssembler</a></li>
<li><a href="#immutablesetterassembler">ImmutableSetterAssembler</a></li>
<li><a href="#interfaceassembler">InterfaceAssembler</a></li>
<li><a href="#iteratorassembler">IteratorAssembler</a></li>
<li><a href="#jsonserializableassembler">JsonSerializableAssembler</a></li>
<li><a href="#propertyassembler">PropertyAssembler</a></li>
<li><a href="#requestassembler">RequestAssembler</a></li>
<li><a href="#resultassembler">ResultAssembler</a></li>
<li><a href="#resultproviderassembler">ResultProviderAssembler</a></li>
<li><a href="#setterassembler">SetterAssembler</a></li>
<li><a href="#traitassembler">TraitAssembler</a></li>
<li><a href="#useassembler">UseAssembler</a></li>
</ul>
<h2 id="classmapassembler">ClassMapAssembler</h2>
<p>The <code>ClassMapAssembler</code> is activated by default and is used during the <code>generate:classmap</code> command.</p>
<p>Example output:</p>
<pre><code class="php">&lt;?php

use Phpro\SoapClient\Soap\ClassMap\ClassMapCollection;
use Phpro\SoapClient\Soap\ClassMap\ClassMap;

new ClassMapCollection([
        new ClassMap('HelloWorldRequest', \HelloWorldRequest::class),
        new ClassMap('HelloWorldResponse', \HelloWorldResponse::class),
        new ClassMap('Greeting', \Greeting::class),
]);
</code></pre>

<h2 id="constructorassembler">ConstructorAssembler</h2>
<p>The `ConstructorAssembler can be used to add a constructor with all the class properties to the generated class.</p>
<p>Example output:</p>
<pre><code class="php">    /**
     * Constructor
     *
     * @var string $prop1
     * @var int $prop2
     */
    public function __construct($prop1, $prop2)
    {
        $this-&gt;prop1 = $prop1;
        $this-&gt;prop2 = $prop2;
    }
</code></pre>

<h2 id="fluentsetterassembler">FluentSetterAssembler</h2>
<p>The <code>FluentSetterAssembler</code> will add a setter method to the generated class. The method will return the current instance to enable chaining.</p>
<p>Example output:</p>
<pre><code class="php">    /**
     * @param string $prop1
     * @return $this
     */
    public function setProp1($prop1)
    {
        $this-&gt;prop1 = $prop1;
        return $this;
    }
</code></pre>

<p>Generating type-hints is disabled by default, but can be enabled by passing <code>FluentSetterAssemblerOption</code> instance to the constructor with the option withTypeHints set to true.</p>
<p>Example</p>
<pre><code class="php">new FluentSetterAssembler((new FluentSetterAssemblerOptions())-&gt;withTypeHints())
</code></pre>

<pre><code class="php">    /**
     * @param string $prop1
     * @return $this
     */
    public function setProp1(string $prop1)
    {
        $this-&gt;prop1 = $prop1;
        return $this;
    }
</code></pre>

<h2 id="finalclassassembler">FinalClassAssembler</h2>
<p>The <code>FinalClassAssembler</code> can be used to mark a generated class as final.</p>
<p>Example output:</p>
<pre><code class="php">
final class MyType
{


}

</code></pre>

<h2 id="extendassembler">ExtendAssembler</h2>
<p>The <code>ExtendAssembler</code> will add a parent class to the generated class.</p>
<p>Example output:</p>
<pre><code class="php">
class MyType extends DType
{


}
</code></pre>

<h2 id="getterassembler">GetterAssembler</h2>
<p>The <code>GetterAssembler</code> will add a getter method to the generated class.
For boolean types you can opt to use the 'is' function prefix instead of 'get' by enabling this in the constructor.</p>
<p>Example output:</p>
<pre><code class="php">    /**
     * @return string
     */
    public function getProp1()
    {
        return $this-&gt;prop1;
    }
</code></pre>

<p>This assembler needs to be constructed with an instance of <code>GetterAssemblerOptions</code></p>
<h2 id="interfaceassembler">InterfaceAssembler</h2>
<p>The <code>InterfaceAssembler</code> can be used to add a specific interface to the generated class.</p>
<p>Example output:</p>
<pre><code class="php">
use Iterator;

class MyType implements Iterator
{


}
</code></pre>

<h2 id="iteratorassembler">IteratorAssembler</h2>
<p>The <code>IteratorAssembler</code> can be used for SOAP types that contain a list of another SOAP type.
This assembler will make it easy to iterate over the types.</p>
<p>Example output:</p>
<pre><code class="php">use IteratorAggregate;

class MyType implements IteratorAggregate
{

    /**
     * @return \ArrayIterator
     */
    public function getIterator()
    {
        return new \ArrayIterator(is_array($this-&gt;prop1) ? $this-&gt;prop1 : []);
    }


}
</code></pre>

<h2 id="jsonserializableassembler">JsonSerializableAssembler</h2>
<p>The <code>JsonSerializableAssembler</code> can be used if you want to JSON serialize your SOAP objects. 
This could be handy for logging JSON serialized request / response data which makes your logs smaller.</p>
<p>Example output:</p>
<pre><code class="php">use JsonSerializable;

class MyType implements JsonSerializable
{

    /**
     * @return array
     */
    public function jsonSerialize()
    {
        return [
            'prop1' =&gt; \$this-&gt;prop1,
            'prop2' =&gt; \$this-&gt;prop2,
        ];
    }
}
</code></pre>

<h2 id="propertyassembler">PropertyAssembler</h2>
<p>This <code>PropertyAssembler</code> is enabled by default and is used during the <code>generate:types</code> command.</p>
<p>Example output:</p>
<pre><code class="php">    /**
     * @var string
     */
    private $prop1 = null;
</code></pre>

<p>You can adjust the visibility of the property by injecting the visibility in the constructor.</p>
<pre><code class="php">new PropertyAssembler(PropertyGenerator::VISIBILITY_PROTECTED)
</code></pre>

<p>Please note that the default ruleset has a visibility of private.
If you want to override this, you will have to override all rules by calling <code>Phpro\SoapClient\CodeGenerator\Config\Config::setRuleSet</code>.</p>
<h2 id="requestassembler">RequestAssembler</h2>
<p>The <code>RequestAssembler</code> can be used to add the <code>RequestInterface</code> to a generated class.</p>
<p>Example output:</p>
<pre><code class="php">use Phpro\SoapClient\Type\RequestInterface;

class MyType implements RequestInterface
{
}
</code></pre>

<h2 id="resultassembler">ResultAssembler</h2>
<p>The <code>ResultAssembler</code> can be used to add the <code>ResultInterface</code> to a generated class.</p>
<p>Example output:</p>
<pre><code class="php">use Phpro\SoapClient\Type\ResultInterface;

class MyType implements ResultInterface
{
}
</code></pre>

<h2 id="resultproviderassembler">ResultProviderAssembler</h2>
<p>The <code>ResultProviderAssembler</code> can be used to add the <code>ResultProviderInterface</code> to a generated class.</p>
<p>Example output:</p>
<pre><code class="php">use Phpro\SoapClient\Type\ResultProviderInterface;
use Phpro\SoapClient\Type\ResultInterface;

class MyType implements ResultProviderInterface
{

    /**
     * @return SomeClass|ResultInterface
     */
    public function getResult() : \Phpro\SoapClient\Type\ResultInterface
    {
        return $this-&gt;prop1;
    }
}
</code></pre>

<p>It is also possible to add an optional <code>wrapperClass</code> to the constructor.
This way, the result is wrapped with a class you specified.</p>
<p>Example output:</p>
<pre><code class="php">namespace MyNamespace;

use Phpro\SoapClient\Type\ResultProviderInterface;
use Phpro\SoapClient\Type\MixedResult

class MyType implements ResultProviderInterface
{

    /**
     * @return MixedResult
     */
    public function getResult() : \Phpro\SoapClient\Type\ResultInterface
    {
        return new MixedResult($this-&gt;prop1);
    }


}
</code></pre>

<h2 id="setterassembler">SetterAssembler</h2>
<p>The <code>SetterAssembler</code> will add a setter method to the generated class.</p>
<p>Example output:</p>
<pre><code class="php">    /**
     * @param string $prop1
     */
    public function setProp1($prop1)
    {
        $this-&gt;prop1 = $prop1;
    }
</code></pre>

<p>This assembler needs to be constructed with an instance of <code>SetterAssemblerOptions</code>.</p>
<h2 id="traitassembler">TraitAssembler</h2>
<p>The <code>TraitAssembler</code> can be used to add a specific trait to the generated class. An alias can be used by passing it in as second argument.</p>
<p>Example output:</p>
<pre><code class="php">
use MyTrait;

class MyType
{

    use MyTrait

}
</code></pre>

<h2 id="useassembler">UseAssembler</h2>
<p>The <code>UseAssembler</code> can be used to add usage statements to the generated class. Often used internally to add uses for interfaces or traits. An alias can be used by passing it in as second argument.</p>
<p>Example output:</p>
<pre><code class="php">
use MyTrait as TraitAlias;

class MyType
{


}
</code></pre>

<h2 id="immutablesetterassembler">ImmutableSetterAssembler</h2>
<p>The <code>ImmutableSetterAssembler</code> generates immutable setters that return a new instance with the new value set.
Used to create variations of the same base instance, without modifying the original values.</p>
<p>Example output:</p>
<pre><code class="php">    /**
     * @param string $prop1
     * @return MyType
     */
    public function withProp1($prop1)
    {
        $new = clone $this;
        $new-&gt;prop1 = $prop1;

        return $new;
    }
</code></pre>

<h1 id="creating-your-own-assembler">Creating your own Assembler</h1>
<p>Creating your own Assembler is pretty easy. 
The only thing you'll need to do is implementing the <code>AssemblerInterface</code>.
You can use the <a href="https://github.com/zendframework/zend-code">zend-code</a> <code>ClassGenerator</code> and <code>FileGenerator</code> to manipulate your code.</p>
<pre><code class="php">/**
 * Interface AssemblerInterface
 *
 * @package Phpro\SoapClient\CodeGenerator\Assembler
 */
interface AssemblerInterface
{

    /**
     * @param ContextInterface $context
     *
     * @return bool
     */
    public function canAssemble(ContextInterface $context);

    /**
     * Assembles pieces of code.
     *
     * @param ContextInterface $context
     * @throws AssemblerException
     */
    public function assemble(ContextInterface $context);
}
</code></pre>

<p>Possible contexts:</p>
<ul>
<li><code>ClassMapContext</code>: Triggered during the <code>generate:classmap</code> command.</li>
<li><code>TypeContext</code>: Triggered during the <code>generate:types</code> command for every type in the SOAP scheme.</li>
<li><code>PropertyContext</code>: Triggered during the <code>generate:types</code> command for every property in a SOAP type.</li>
</ul>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../configuration/" class="btn btn-neutral float-right" title="Configuration">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../../cli/generate-types/" class="btn btn-neutral" title="Generating Value-objects"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
      
        <span><a href="../../cli/generate-types/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../configuration/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '../..';</script>
    <script src="../../js/theme.js" defer></script>
      <script src="../../search/main.js" defer></script>

</body>
</html>
