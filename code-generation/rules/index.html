<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  <link rel="shortcut icon" href="../../img/favicon.ico">
  <title>Code generation rules - SOAP Client Docs</title>
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">
  
  <script>
    // Current page data
    var mkdocs_page_name = "Code generation rules";
    var mkdocs_page_input_path = "code-generation/rules.md";
    var mkdocs_page_url = null;
  </script>
  
  <script src="../../js/jquery-2.1.1.min.js" defer></script>
  <script src="../../js/modernizr-2.8.3.min.js" defer></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href="../.." class="icon icon-home"> SOAP Client Docs</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
	<ul class="current">
	  
          
            <li class="toctree-l1">
		
    <a class="" href="../..">Home</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../../client/">Creating your custom client</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../../events/">Hooking in with events</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../../handlers/">Use your preferred data transfer layer with Handlers</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../../middlewares/">Get control of the HTTP layer with middlewares</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../../testing/">Testing</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../../type-converter/">Convert SOAP types</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../../usage/">Basic Usage</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../../wsdl-providers/">Get in control of the WSDL file</a>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Cli</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../cli/generate-classmap/">Generating class maps</a>
                </li>
                <li class="">
                    
    <a class="" href="../../cli/generate-client/">Generating clients</a>
                </li>
                <li class="">
                    
    <a class="" href="../../cli/generate-clientfactory/">Generate a base client factory</a>
                </li>
                <li class="">
                    
    <a class="" href="../../cli/generate-types/">Generating Value-objects</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Code generation</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../assemblers/">Code assemblers</a>
                </li>
                <li class="">
                    
    <a class="" href="../configuration/">Configuration</a>
                </li>
                <li class=" current">
                    
    <a class="current" href="./">Code generation rules</a>
    <ul class="subnav">
            
    <li class="toctree-l3"><a href="#code-generation-rules">Code generation rules</a></li>
    

    <li class="toctree-l3"><a href="#built-in-rules">Built-in rules</a></li>
    
        <ul>
        
            <li><a class="toctree-l4" href="#assemblerrule">AssemblerRule</a></li>
        
            <li><a class="toctree-l4" href="#clientmethodmatchesrule">ClientMethodMatchesRule</a></li>
        
            <li><a class="toctree-l4" href="#multirule">MultiRule</a></li>
        
            <li><a class="toctree-l4" href="#propertynamematchesrule">PropertynameMatchesRule</a></li>
        
            <li><a class="toctree-l4" href="#typemaprule">TypeMapRule</a></li>
        
            <li><a class="toctree-l4" href="#typenamematchesrule">TypenameMatchesRule</a></li>
        
        </ul>
    

    <li class="toctree-l3"><a href="#creating-your-own-rule">Creating your own Rule</a></li>
    

    </ul>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">Plugins</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../plugins/caching/">Caching plugin</a>
                </li>
                <li class="">
                    
    <a class="" href="../../plugins/logger/">Logger plugin</a>
                </li>
                <li class="">
                    
    <a class="" href="../../plugins/validator/">Validator plugin</a>
                </li>
    </ul>
	    </li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../..">SOAP Client Docs</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../..">Docs</a> &raquo;</li>
    
      
        
          <li>Code generation &raquo;</li>
        
      
    
    <li>Code generation rules</li>
    <li class="wy-breadcrumbs-aside">
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="code-generation-rules">Code generation rules</h1>
<p>Since every application has it's own rules on how to write and structure code,
we made it possible to configure the way your code is auto generated.
You can specify your own rules and apply them to the code generator.</p>
<p>The goal of a rule is to run a code assembler.
<a href="../assemblers/#built-in-assemblers">Here you can find a full list of built-in code assemblers</a>.</p>
<h1 id="built-in-rules">Built-in rules</h1>
<ul>
<li><a href="#assemblerrule">AssemblerRule</a></li>
<li><a href="#clientmethodmatchesrule">ClientMethodMatchesRule</a></li>
<li><a href="#multirule">MultiRule</a></li>
<li><a href="#propertynamematchesrule">PopertynameMatchesRule</a></li>
<li><a href="#TypeMapRule">TypeMapRule</a></li>
<li><a href="#typenamematchesrule">TypenameMatchesRule</a></li>
</ul>
<h2 id="assemblerrule">AssemblerRule</h2>
<pre><code class="php">use Phpro\SoapClient\CodeGenerator\Assembler;
use Phpro\SoapClient\CodeGenerator\Rules;

$rule = Rules\AssembleRule(new Assembler\GetterAssembler($someGetterOptions))
</code></pre>

<p>The <code>AssemblerRule</code> will always apply an assembler in the right context. 
This way, the code is added during every code generation command.</p>
<p>In the example above, a getter will be created for every property in the SOAP type.</p>
<h2 id="clientmethodmatchesrule">ClientMethodMatchesRule</h2>
<pre><code class="php">use My\Project\CodeGenerator\Assembler as CustomAssembler;
use Phpro\SoapClient\CodeGenerator\Assembler;
use Phpro\SoapClient\CodeGenerator\Rules;

new Rules\ClientMethodMatchesRule(
    new Rules\AssembleRule(new CustomAssembler\RemoveClientMethodAssembler()),
    '/demoSetup$/'
)
</code></pre>

<p>The <code>ClientMethodMatchesRule</code> can be used in the types generation command and contains a subRule and a regular expression.
The subRule is mostly a regular AssembleRule, but can be any class that implements the RuleInterface.
The regular expression will be matched against the method name added to the generated Client. 
If the regular expression matches and the subRule is accepted, the defined assembler will run.</p>
<p>In the example above, a custom <code>RemoveClientMethodAssembler</code> is is used to remove the <code>demoSetup</code> method from the Client completely.</p>
<h2 id="multirule">MultiRule</h2>
<pre><code>use Phpro\SoapClient\CodeGenerator\Assembler;
use Phpro\SoapClient\CodeGenerator\Rules;

$rule = Rules\MultiRule([
    Rules\AssembleRule(new Assembler\GetterAssembler($someGetterOptions)),
    Rules\AssembleRule(new Assembler\SetterAssembler()),
]);
</code></pre>

<p>The <code>MultiRule</code> makes it possible to define multiple rules that need to be applied on a SOAP type.
This rule can be very handy in combination with rules like the <code>TypeMapRule</code> or <code>TypenameMatchesRule</code>.
By using the <code>MultiRule</code>, you can e.g. specify the regex once but run multiple assemblers.</p>
<p>In the example above, both the getters and setters are added for every property in the SOAP type.</p>
<h2 id="propertynamematchesrule">PropertynameMatchesRule</h2>
<pre><code class="php">use Phpro\SoapClient\CodeGenerator\Assembler;
use Phpro\SoapClient\CodeGenerator\Rules;

new Rules\PropertynameMatchesRule(
    new Rules\AssembleRule(new Assembler\InterfaceAssembler(ApiKeyAwareInterface::class)),
    '/^ApiKey$/'
)
</code></pre>

<p>The <code>PropertynameMatchesRule</code> can be used in the types generation command and contains a subRule and a regular expression.
The subRule is mostly a regular AssmbleRule, but can be any class that implements the RuleInterface.
The regular expression will be matched against the normalized SOAP property name. 
If the regular expression matches and the subRule is accepted, the defined assembler will run.</p>
<p>In the example above, the <code>ApiKeyAwareInterface</code> is added to the class if the SOAP property <code>ApiKey</code> exists.</p>
<h2 id="typemaprule">TypeMapRule</h2>
<pre><code class="php">use Phpro\SoapClient\CodeGenerator\Assembler;
use Phpro\SoapClient\CodeGenerator\Rules;

$resultProviderRule = new Rules\AssembleRule(new Assembler\ResultProviderAssembler());
$defaultRule = new Rules\AssembleRule(new Assembler\ResultAssembler());

new Rules\TypeMapRule(
    [
        'SomeType' =&gt; $resultProviderRule,
        'NullType' =&gt; null
    ]
    $defaultRule
)
</code></pre>

<p>The <code>TypeMapRule</code> can be used in the types generation command and contains a map of types with a subrule.
When the SOAP type is found in the TypeMap, the configured rule will be applied.
The last parameter is the default rule. When the type cannot be found in the TypeMap, the default Rule will apply.
This rule will make it easy to apply some specific rules for specific templates.</p>
<p>In the example above, the <code>ResultProviderInterface</code> is added to the class if the SOAP type equals <code>SomeType</code>.
On the SOAP type <code>NullType</code>, no actions are executed.
On all other SOAP types, the <code>ResultInterface</code> is added.</p>
<h2 id="typenamematchesrule">TypenameMatchesRule</h2>
<pre><code class="php">use Phpro\SoapClient\CodeGenerator\Assembler;
use Phpro\SoapClient\CodeGenerator\Rules;

new Rules\TypenameMatchesRule(
    new Rules\AssembleRule(new Assembler\RequestAssembler()),
    '/Request$/'
)
</code></pre>

<p>The <code>TypenameMatchesRule</code> can be used in the types generation command and contains a subRule and a regular expression.
The subRule is mostly a regular AssembleRule, but can be any class that implements the RuleInterface.
The regular expression will be matched against the normalized SOAP type name. 
If the regular expression matches and the subRule is accepted, the defined assembler will run.</p>
<p>In the example above, the <code>RequestInterface</code> is added to the class if the SOAP type ends on <code>Request</code>.</p>
<h1 id="creating-your-own-rule">Creating your own Rule</h1>
<p>Creating your own Rule is pretty easy. 
The only thing you'll need to do is implementing the <code>RuleInterface</code>.</p>
<pre><code class="php">/**
 * Interface RuleInterface
 *
 * @package Phpro\SoapClient\CodeGenerator\Rules
 */
interface RuleInterface
{
    /**
     * @param ContextInterface $context
     *
     * @return bool
     */
    public function appliesToContext(ContextInterface $context);

    /**
     * @param ContextInterface $context
     */
    public function apply(ContextInterface $context);
}
</code></pre>

<p>Possible contexts:</p>
<ul>
<li><code>ClassMapContext</code>: Triggered during the <code>generate:classmap</code> command.</li>
<li><code>TypeContext</code>: Triggered during the <code>generate:types</code> command for every type in the SOAP scheme.</li>
<li><code>PropertyContext</code>: Triggered during the <code>generate:types</code> command for every property in a SOAP type.</li>
</ul>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../../plugins/caching/" class="btn btn-neutral float-right" title="Caching plugin">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../configuration/" class="btn btn-neutral" title="Configuration"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
      
        <span><a href="../configuration/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../../plugins/caching/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '../..';</script>
    <script src="../../js/theme.js" defer></script>
      <script src="../../search/main.js" defer></script>

</body>
</html>
